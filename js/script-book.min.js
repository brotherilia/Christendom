$(document).ready(function(){var chapterIdx,currentChapter,itmMenu=($("#main-menu"),$("#itm-menu")),lnkMenuOpen=$("#lnk-menu-open"),itmBack=$("#itm-back"),lnkBackToText=$("#lnk-back-to-text"),itmHome=$("#itm-home"),popupMenu=$("#popup-menu"),lnkPopupMenuClose=$("#lnk-popup-menu-close"),itmContents=$("#itm-contents"),lnkContents=$("#lnk-contents"),popupSettings=$("#popup-settings"),lnkSettingsOpen=$("#lnk-settings-open"),lnkSettingsClose=$("#lnk-settings-close"),lnkFontSizeDecrease=$("#lnk-font-size-decrease"),lnkFontSizeIncrease=$("#lnk-font-size-increase"),fontSize=$("html, body").css("font-size").substr(0,2),langRu=$(".lang-ru"),langEn=$(".lang-en"),lnkLangRu=$("#lnk-lang-ru"),lnkLangEn=$("#lnk-lang-en"),lnkFontSans=$("#lnk-font-sans"),lnkFontSerif=$("#lnk-font-serif"),bottomMenu=$("#bottom-menu"),lnkPrevChapter=$("#lnk-prev-chapter"),lnkNextChapter=$("#lnk-next-chapter"),lnkToTop=$("#lnk-to-top"),contents=$(".book__contents"),bookTitle=$(".book__title"),chapterLink=$(".book__contents-link"),runningTitle=$("#running-title"),chapter=$(".book__chapter"),firstChapter=chapter.first(),lastChapter=chapter.last(),firstChapterIdx=chapter.index(firstChapter),lastChapterIdx=chapter.index(lastChapter),currentChapterNumberMark=$("#current-chapter-number"),setupChapter=function(){chapter.hide(),lnkPrevChapter.text(chapterIdx),lnkNextChapter.text(chapterIdx+2),currentChapterNumberMark.text(chapterIdx+1),runningTitle.show(),chapterIdx==firstChapterIdx?(lnkPrevChapter.hide(),lnkNextChapter.show()):chapterIdx==lastChapterIdx?(lnkNextChapter.hide(),lnkPrevChapter.show()):(lnkPrevChapter.show(),lnkNextChapter.show())},showChapter=function(){currentChapter=chapter.eq(chapterIdx),currentChapter.fadeIn(600),$("html, body").animate({scrollTop:0},0)};lnkToTop.click(function(){event.preventDefault(),$("html, body").animate({scrollTop:0},600)}),lnkMenuOpen.click(function(){event.preventDefault(),itmMenu.hide(),bookTitle.css({opacity:"0"}),"none"!=contents.css("display")?itmContents.hide():itmContents.show(),popupMenu.fadeIn(600)}),lnkPopupMenuClose.click(function(){event.preventDefault(),popupMenu.fadeOut(600),itmMenu.show(),bookTitle.css({opacity:"1"})}),chapter.hide(),bottomMenu.hide(),runningTitle.hide(),itmMenu.show(),lnkFontSerif.css({color:"#ffffff"}).css({"background-color":"#c6c8d6"}),lnkFontSans.css({color:"#878a9d"}).css({"background-color":"#676a7e"}),lnkLangRu.css({color:"#ffffff"}).css({"background-color":"#c6c8d6"}),lnkLangEn.css({color:"#878a9d"}).css({"background-color":"#676a7e"}),langEn.hide(),langRu.show(),$(chapterLink).click(function(event){event.preventDefault(),chapterIdx=chapterLink.index(this),itmHome.hide(),itmBack.hide(),contents.hide(),bottomMenu.show(),itmMenu.show(),$(setupChapter),$(showChapter)}),lnkPrevChapter.click(function(){event.preventDefault(),chapterIdx--,$(setupChapter),$(showChapter)}),lnkNextChapter.click(function(){event.preventDefault(),chapterIdx++,$(setupChapter),$(showChapter)}),lnkContents.click(function(){event.preventDefault(),chapter.hide(),popupMenu.hide(),bottomMenu.hide(),runningTitle.hide(),itmBack.show(),contents.fadeIn(600)}),lnkBackToText.click(function(){event.preventDefault(),itmBack.hide(),contents.hide(),bottomMenu.show(),runningTitle.show(),itmMenu.show(),$(setupChapter),$(showChapter)}),lnkSettingsOpen.click(function(){event.preventDefault(),popupMenu.fadeOut(600),popupSettings.fadeIn(600)}),lnkSettingsClose.click(function(){event.preventDefault(),popupSettings.fadeOut(600),itmMenu.show(),bookTitle.css({opacity:"1"})}),lnkFontSans.click(function(){$(this).css({color:"#ffffff"}).css({"background-color":"#c6c8d6"}),lnkFontSerif.css({color:"#878a9d"}).css({"background-color":"#676a7e"}),$("html, body").css({"font-family":"'PT Sans', Arial, sans-serif"})}),lnkFontSerif.click(function(){$(this).css({color:"#ffffff"}).css({"background-color":"#c6c8d6"}),lnkFontSans.css({color:"#878a9d"}).css({"background-color":"#676a7e"}),$("html, body").css({"font-family":"'PT Serif', Georgia, serif"})}),lnkFontSizeDecrease.click(function(){event.preventDefault(),fontSize>10&&(fontSize--,$("html, body").css({"font-size":fontSize+"px"}))}),lnkFontSizeIncrease.click(function(){event.preventDefault(),fontSize<24&&(fontSize++,$("html, body").css({"font-size":fontSize+"px"}))}),lnkLangEn.click(function(){$(this).css({color:"#ffffff"}).css({"background-color":"#c6c8d6"}),lnkLangRu.css({color:"#878a9d"}).css({"background-color":"#676a7e"}),langRu.hide(),langEn.show()}),lnkLangRu.click(function(){$(this).css({color:"#ffffff"}).css({"background-color":"#c6c8d6"}),lnkLangEn.css({color:"#878a9d"}).css({"background-color":"#676a7e"}),langEn.hide(),langRu.show()})});